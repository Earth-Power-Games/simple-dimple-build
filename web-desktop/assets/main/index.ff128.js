window.__require=function t(e,o,r){function n(c,a){if(!o[c]){if(!e[c]){var s=c.split("/");if(s=s[s.length-1],!e[s]){var l="function"==typeof __require&&__require;if(!a&&l)return l(s,!0);if(i)return i(s,!0);throw new Error("Cannot find module '"+c+"'")}c=s}var u=o[c]={exports:{}};e[c][0].call(u.exports,function(t){return n(e[c][1][t]||t)},u,u.exports,t,e,o,r)}return o[c].exports}for(var i="function"==typeof __require&&__require,c=0;c<r.length;c++)n(r[c]);return n}({BossHandler:[function(t,e,o){"use strict";cc._RF.push(e,"9ba83WH5qlFE5ITXp8VbGeq","BossHandler");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,c=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(c=(i<3?n(c):i>3?n(e,o,c):n(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=c.property,l=t("./Wallet"),u=t("./CharacterManager"),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.button=null,e.progressBar=null,e.wallet=null,e.characterManager=null,e.config={allowedTime:5,moneyNeeded:100},e.isActive=!1,e.currentTime=0,e}return n(e,t),e.prototype.onLoad=function(){this.button.active=!1,this.progressBar.node.active=!1},e.prototype.onEnable=function(){this.wallet.node.on("AMOUNT_CHANGED",this.onWalletAmountChanged,this),this.characterManager.mainCharacter.node.on("BUBBLE_CLICKED",this.onBubbleClicked,this),this.characterManager.node.on("CHARACTER_GENERATED",this.onCharacterGenerated,this)},e.prototype.onDisable=function(){this.wallet.node.off("AMOUNT_CHANGED",this.onWalletAmountChanged,this),this.characterManager.mainCharacter.node.off("BUBBLE_CLICKED",this.onBubbleClicked,this),this.characterManager.node.off("CHARACTER_GENERATED",this.onCharacterGenerated,this)},e.prototype.update=function(t){this.isActive&&(this.currentTime+=t,this.progressBar.progress=this.currentTime/this.config.allowedTime,this.currentTime>=this.config.allowedTime&&(this.isActive=!1,this.wallet.setMoney(66),this.progressBar.node.active=!1,console.log("lose against boss")))},e.prototype.onCharacterGenerated=function(t){"boss"==t.type&&(this.wallet.subtractMoney(this.config.moneyNeeded),this.currentTime=this.progressBar.progress=0,this.isActive=!0,this.button.active=!1,this.progressBar.node.active=!0)},e.prototype.onBubbleClicked=function(t){t.isEnd&&this.isActive&&(this.isActive=!1,this.wallet.setMoney(77),this.progressBar.node.active=!1,console.log("boss defeated"))},e.prototype.onWalletAmountChanged=function(){this.wallet.data.money>=this.config.moneyNeeded&&!this.isActive&&(this.button.active=!0)},e.prototype.onBossButtonClicked=function(){this.characterManager.generateBoss()},i([s(cc.Node)],e.prototype,"button",void 0),i([s(cc.ProgressBar)],e.prototype,"progressBar",void 0),i([s(l.default)],e.prototype,"wallet",void 0),i([s(u.default)],e.prototype,"characterManager",void 0),i([a],e)}(cc.Component);o.default=p,cc._RF.pop()},{"./CharacterManager":"CharacterManager","./Wallet":"Wallet"}],BubbleClickHandler:[function(t,e,o){"use strict";cc._RF.push(e,"b2efb80fT1F7L+UGzIcXuSE","BubbleClickHandler");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,c=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(c=(i<3?n(c):i>3?n(e,o,c):n(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=c.property,l=t("./CharacterManager"),u=t("./Wallet"),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.characterManager=null,e.wallet=null,e.audioSource=null,e.clickAudioClip=null,e.rewardConfig={singleBubble:1,fullCharacter:10,boss:25},e}return n(e,t),e.prototype.start=function(){this.audioSource.clip=this.clickAudioClip},e.prototype.onEnable=function(){this.characterManager.mainCharacter.node.on("BUBBLE_CLICKED",this.onBubbleClicked,this)},e.prototype.onDisable=function(){this.characterManager.mainCharacter.node.off("BUBBLE_CLICKED",this.onBubbleClicked,this)},e.prototype.onBubbleClicked=function(t){t.isEnd&&this.wallet.addMoney(this.rewardConfig.fullCharacter),this.wallet.addMoney(this.rewardConfig.singleBubble),this.audioSource.play()},i([s(l.default)],e.prototype,"characterManager",void 0),i([s(u.default)],e.prototype,"wallet",void 0),i([s(cc.AudioSource)],e.prototype,"audioSource",void 0),i([s(cc.AudioClip)],e.prototype,"clickAudioClip",void 0),i([a],e)}(cc.Component);o.default=p,cc._RF.pop()},{"./CharacterManager":"CharacterManager","./Wallet":"Wallet"}],Bubble:[function(t,e,o){"use strict";cc._RF.push(e,"5bc4bEYHrBIp7IncWlfDbfS","Bubble");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,c=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(c=(i<3?n(c):i>3?n(e,o,c):n(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isActive=!0,e.sprite=null,e.activeSprite=null,e.inactiveSprite=null,e.activeColor="",e.inactiveColor="",e}return n(e,t),e.prototype.onLoad=function(){this.sprite=this.node.getComponent(cc.Sprite)},e.prototype.initSprites=function(t,e){this.activeSprite=t,this.inactiveSprite=e},e.prototype.initColors=function(t,e){this.activeColor=t,this.inactiveColor=e},e.prototype.changeState=function(t){this.isActive=t,this.sprite.spriteFrame=t?this.activeSprite:this.inactiveSprite,this.node.color=cc.Color.fromHEX(new cc.Color,t?this.activeColor:this.inactiveColor)},i([a],e)}(cc.Component));o.default=s,cc._RF.pop()},{}],CharacterManager:[function(t,e,o){"use strict";cc._RF.push(e,"7b4d9jjQU5MdpQ5fBCR29L2","CharacterManager");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,c=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(c=(i<3?n(c):i>3?n(e,o,c):n(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c},c=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function c(t){try{s(r.next(t))}catch(e){i(e)}}function a(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(c,a)}s((r=r.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var o,r,n,i,c={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(t){return function(e){return s([t,e])}}function s(i){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(n=(n=c.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){c.label=i[1];break}if(6===i[0]&&c.label<n[1]){c.label=n[1],n=i;break}if(n&&c.label<n[2]){c.label=n[2],c.ops.push(i);break}n[2]&&c.ops.pop(),c.trys.pop();continue}i=e.call(t,c)}catch(a){i=[6,a],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__spreadArrays||function(){for(var t=0,e=0,o=arguments.length;e<o;e++)t+=arguments[e].length;var r=Array(t),n=0;for(e=0;e<o;e++)for(var i=arguments[e],c=0,a=i.length;c<a;c++,n++)r[n]=i[c];return r};Object.defineProperty(o,"__esModule",{value:!0});var l=cc._decorator,u=l.ccclass,p=l.property,h=t("./Character"),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mainCharacter=null,e.characters=null,e.bosses=null,e.currentIndex=0,e.characterIndex=0,e}return n(e,t),e.prototype.onEnable=function(){this.mainCharacter.node.on("BUBBLE_CLICKED",this.onBubbleClicked,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this)},e.prototype.onDisable=function(){this.mainCharacter.node.off("BUBBLE_CLICKED",this.onBubbleClicked,this),cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this)},e.prototype.start=function(){this.loadData()},e.prototype.onKeyDown=function(t){t.keyCode==cc.macro.KEY.space&&this.mainCharacter.startAutoClick()},e.prototype.onBubbleClicked=function(t){t.isEnd&&this.generateCharacter()},e.prototype.generateCharacter=function(){this.characterIndex=(this.characterIndex+1)%this.characters.length,this.mainCharacter.init(this.getNextCharacter()),this.node.emit("CHARACTER_GENERATED",{type:"normal"})},e.prototype.generateBoss=function(){this.node.emit("CHARACTER_GENERATED",{type:"boss"})},e.prototype.loadData=function(){return c(this,void 0,void 0,function(){var t,e;return a(this,function(o){switch(o.label){case 0:return t=this,[4,this.loadConfigs("config/characters")];case 1:return t.characters=o.sent(),e=this,[4,this.loadConfigs("config/bosses")];case 2:return e.bosses=o.sent(),this.generateCharacter(),[2]}})})},e.prototype.getNextCharacter=function(){return this.characters[this.characterIndex].json},e.prototype.getNextBoss=function(){return this.bosses[0].json},e.prototype.loadConfigs=function(t){return new Promise(function(e,o){cc.resources.loadDir(t,function(t,r){t&&o(t),e(r)})})},e.prototype.shuffleArray=function(t){for(var e=s(t),o=e.length-1;o>0;o--){var r=Math.floor(Math.random()*(o+1)),n=e[o];e[o]=e[r],e[r]=n}return e},i([p(h.default)],e.prototype,"mainCharacter",void 0),i([u],e)}(cc.Component);o.default=f,cc._RF.pop()},{"./Character":"Character"}],Character:[function(t,e,o){"use strict";cc._RF.push(e,"68f81Dyc1BGopymCVBYvpfG","Character");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,c=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(c=(i<3?n(c):i>3?n(e,o,c):n(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=c.property,l=t("./Bubble"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bubblePrefab=null,e.label=null,e.sprite=null,e.bubblesParent=null,e.activeSprite=null,e.inactiveSprite=null,e.bubbles=null,e.clickedAmount=0,e.amount=0,e.rect=null,e}return n(e,t),e.prototype.onLoad=function(){var t=new cc.Vec2(this.sprite.node.width,this.sprite.node.height);t.mulSelf(.5),this.rect={t:t.y,b:-t.y,l:-t.x,r:t.x}},e.prototype.updateLabel=function(){this.label.string=this.clickedAmount+"/"+this.amount},e.prototype.onBubbleClick=function(t){if(t.isActive){t.changeState(!1),this.clickedAmount++,this.updateLabel();var e=this.clickedAmount==this.amount;this.node.emit("BUBBLE_CLICKED",{isEnd:e})}},e.prototype.startAutoClick=function(){var t=this,e=this.bubbles.filter(function(t){return t.isActive}),o=e.length-1;if(o>0){var r=0;this.schedule(function(){t.onBubbleClick(e[r++])},.2,o)}},e.prototype.init=function(t){var e=this;this.initBubbles(t.bubbles,t.colorActive,t.colorInactive),cc.loader.loadRes(t.sprite,cc.SpriteFrame,function(t,o){e.sprite.spriteFrame=o}),this.clickedAmount=0,this.amount=this.bubblesParent.children.length,this.updateLabel()},e.prototype.initBubbles=function(t,e,o){var r=this;this.bubblesParent.removeAllChildren(),this.bubbles=t.map(function(t){var e=cc.instantiate(r.bubblePrefab);e.on(cc.Node.EventType.TOUCH_START,function(){return r.onBubbleClick(o)},r),e.parent=r.bubblesParent,e.position=r.convertPosition(t);var o=e.getComponent(l.default);return o}),this.bubbles.forEach(function(t){t.initSprites(r.activeSprite,r.inactiveSprite),t.initColors(e,o),t.changeState(!0)})},e.prototype.convertPosition=function(t){var e=t.x,o=t.y;return e=cc.misc.lerp(this.rect.l,this.rect.r,e),o=cc.misc.lerp(this.rect.b,this.rect.t,o),new cc.Vec3(e,o,0)},i([s(cc.Prefab)],e.prototype,"bubblePrefab",void 0),i([s(cc.Label)],e.prototype,"label",void 0),i([s(cc.Sprite)],e.prototype,"sprite",void 0),i([s(cc.Node)],e.prototype,"bubblesParent",void 0),i([s(cc.SpriteFrame)],e.prototype,"activeSprite",void 0),i([s(cc.SpriteFrame)],e.prototype,"inactiveSprite",void 0),i([a],e)}(cc.Component);o.default=u,cc._RF.pop()},{"./Bubble":"Bubble"}],WalletCurrencyLabel:[function(t,e,o){"use strict";cc._RF.push(e,"2ea93c42rFF46tGps7mVG3R","WalletCurrencyLabel");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,c=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(c=(i<3?n(c):i>3?n(e,o,c):n(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=c.property,l=t("./Wallet"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.currencyType="money",e.label=null,e.wallet=null,e}return n(e,t),e.prototype.onEnable=function(){this.wallet.node.on("AMOUNT_CHANGED",this.onWalletAmountChanged,this)},e.prototype.onDisable=function(){this.wallet.node.off("AMOUNT_CHANGED",this.onWalletAmountChanged,this)},e.prototype.onWalletAmountChanged=function(){this.updateText()},e.prototype.updateText=function(){this.label.string=""+this.wallet.data[this.currencyType]},i([s],e.prototype,"currencyType",void 0),i([s(cc.Label)],e.prototype,"label",void 0),i([s(l.default)],e.prototype,"wallet",void 0),i([a],e)}(cc.Component);o.default=u,cc._RF.pop()},{"./Wallet":"Wallet"}],Wallet:[function(t,e,o){"use strict";cc._RF.push(e,"02689JoYp5Ekp3z9+Jljzcf","Wallet");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,c=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(c=(i<3?n(c):i>3?n(e,o,c):n(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=(c.property,function(){function t(){}return t.save=function(t,e){try{localStorage.setItem(t,e)}catch(o){console.warn(o)}},t.load=function(t){try{return localStorage.getItem(t)}catch(e){console.warn(e)}},t}()),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.data={money:146},e}return n(e,t),e.prototype.onLoad=function(){var t=s.load("wallet");t&&(this.data=JSON.parse(t))},e.prototype.start=function(){this.emitMoneyChangedEvent()},e.prototype.save=function(){s.save("wallet",JSON.stringify(this.data))},e.prototype.addMoney=function(t){this.data.money+=t,this.save(),this.emitMoneyChangedEvent()},e.prototype.subtractMoney=function(t){this.data.money-=t,this.save(),this.emitMoneyChangedEvent()},e.prototype.setMoney=function(t){this.data.money=t,this.save(),this.emitMoneyChangedEvent()},e.prototype.emitMoneyChangedEvent=function(){this.node.emit("AMOUNT_CHANGED")},i([a],e)}(cc.Component);o.default=l,cc._RF.pop()},{}]},{},["BossHandler","Bubble","BubbleClickHandler","Character","CharacterManager","Wallet","WalletCurrencyLabel"]);